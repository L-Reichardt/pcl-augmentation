# Launching Real3D-Aug for semantic dataset

## 1. Adjusting config file

- Adjust paths
   - *dataset_path* - path to dataset files
   - *maps_path* - path to directory, where created map will be stored (path must end with: /maps/small/npz, but these directories is created automatically)
   - *annotation_path* - path to directory, where created bouding boxes of frame objects will be stored
   - *bbox_path* - path to directory, where cutted objects will be stored
   - *output_path* - path to directory, where outputs of the algorithm will be stored
- Insertion paramethers
   - *classes* - set of classes indexes, which would augment frames (all these classes need to have filled: min_points, placement, labels_shortcut and labels)
   - *min_points* - minimal number of object points, which need to be visible to add object to frame
   - *random* - bool variable, if it is **True** method adds to frames as many objects as value of *number_of_object* is, however number of samples of each class will be randomly generated. If it is **False** algorithm uses *number_of_classes* as number of samples of each class, which adds to frames
   - *number_of_object* - number of objects, which are placed in frame (relevant only if *random* is **True**)
   - *number_of_classes* - list with same shape as *classes*. Values in list represent number of samples, which will be places in frame, of corresponding class in *classes*
   - *placement*[^*] - list of "surfaces", where object can be located. These "surfaces" are deffined by *placement_labels*.
   - *placement_labels*[^*] - list of labels, which create placement location, e.g. road is combination of points annotated as Road and Lane-marking
   - *labels_shortcut* - shortcut of classes name (1-3 letters recommended)
   - *labels* - full names of classes


[^*]: placements indexes are arbitrary, in semantic-kitti.yaml 1 stands for road, 2 for sidewalk and 3 for parking. However in waymo.yaml 1 stand for road, 2 for sidewalk and 3 for crosswalk.

## 2. Data preprocessing
- **Rich maps**  
Rich maps are generated by running python script [drivable_area_map.py](rich_map/drivable_area_map.py). Script has boolen *DEBUG* variable. If this variable is set to **True**, script along side maps in .npz format (used further) create .png pictures of maps. Both Semantic-KITTI and Waymo dataset is captured in sequences, therefore algorithm will created one map for whole sequence.
- **Object database**  
Object database is created by running python script [cut_out.py](cut_object/cut_out.py). Script cut out only classes, which will be used for augmentation (based on config file). Further we recommned filter these object by running [filter_objects.py](cut_object/filter_objects.py) in order to remove already occluded samples from database.
- Bounding box estimation
Can run augmentation the procedure by running the python script TASK/Real3D-Aug/insertion.py with modified path to the original dataset.
